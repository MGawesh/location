<!DOCTYPE html>
<html lang="ar">
<head>
  <meta charset="UTF-8">
  <title>Ø£Ù‚Ø±Ø¨ ØµÙŠØ¯Ù„ÙŠØ©</title>
  <style>
    #map {
      height: 100vh;
      width: 100%;
    }
  </style>
</head>
<body>
  <div id="map"></div>

  <script>
    const pharmacies = [
      { name: "ØµÙŠØ¯Ù„ÙŠØ© Ø§Ù„Ø±Ø­Ù…Ø©", lat: 30.0444, lng: 31.2357 },
      { name: "ØµÙŠØ¯Ù„ÙŠØ© Ø§Ù„Ø´ÙØ§Ø¡", lat: 30.0500, lng: 31.2400 },
      { name: "ØµÙŠØ¯Ù„ÙŠØ© Ø§Ù„Ø³Ù„Ø§Ù…", lat: 30.0465, lng: 31.2380 },
      { name: "ØµÙŠØ¯Ù„ÙŠØ© Ù†ÙˆØ±", lat: 30.0480, lng: 31.2365 },
      { name: "ØµÙŠØ¯Ù„ÙŠØ© Ø§Ù„Ø­ÙŠØ§Ø©", lat: 30.0455, lng: 31.2330 },
      { name: "ØµÙŠØ¯Ù„ÙŠØ© Ø§Ù„Ø¨ÙŠØ§Ù†", lat: 30.0472, lng: 31.2372 },
      { name: "ØµÙŠØ¯Ù„ÙŠØ© Ø§Ù„Ù…Ø³ØªÙ‚Ø¨Ù„", lat: 30.0430, lng: 31.2395 },
      { name: "ØµÙŠØ¯Ù„ÙŠØ© Ø§Ù„Ø¹Ø±Ø¨", lat: 30.0490, lng: 31.2340 },
      { name: "ØµÙŠØ¯Ù„ÙŠØ© Ù…ÙŠÙ†Ø§", lat: 30.0422, lng: 31.2360 },
      { name: "ØµÙŠØ¯Ù„ÙŠØ© Ø³ÙŠÙ", lat: 30.0410, lng: 31.2388 },
    ];

    let map;

    function initMap() {
      // Ø®Ø±ÙŠØ·Ø© Ù…Ø¨Ø¯Ø¦ÙŠØ© ÙÙŠ Ø§Ù„Ù‚Ø§Ù‡Ø±Ø©
      map = new google.maps.Map(document.getElementById("map"), {
        center: { lat: 30.0444, lng: 31.2357 },
        zoom: 14,
      });

      // Ø¹Ø±Ø¶ Ø§Ù„ØµÙŠØ¯Ù„ÙŠØ§Øª
      pharmacies.forEach((pharmacy) => {
        new google.maps.Marker({
          position: { lat: pharmacy.lat, lng: pharmacy.lng },
          map: map,
          title: pharmacy.name,
        });
      });

      // Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
      if (navigator.geolocation) {
        navigator.geolocation.getCurrentPosition((position) => {
          const userPos = {
            lat: position.coords.latitude,
            lng: position.coords.longitude,
          };

          // Ø¹Ù„Ø§Ù…Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
          new google.maps.Marker({
            position: userPos,
            map: map,
            icon: 'http://maps.google.com/mapfiles/ms/icons/blue-dot.png',
            title: "Ù…ÙˆÙ‚Ø¹Ùƒ Ø§Ù„Ø­Ø§Ù„ÙŠ",
          });

          map.setCenter(userPos);

          // Ø£Ù‚Ø±Ø¨ ØµÙŠØ¯Ù„ÙŠØ©
          let closest = null;
          let minDist = Number.MAX_VALUE;

          pharmacies.forEach((pharmacy) => {
            const dist = getDistance(userPos.lat, userPos.lng, pharmacy.lat, pharmacy.lng);
            if (dist < minDist) {
              minDist = dist;
              closest = pharmacy;
            }
          });

          alert("Ø£Ù‚Ø±Ø¨ ØµÙŠØ¯Ù„ÙŠØ© Ù„ÙŠÙƒ Ù‡ÙŠ: " + closest.name);
        });
      } else {
        alert("Ø§Ù„Ù…ØªØµÙØ­ Ù„Ø§ ÙŠØ¯Ø¹Ù… ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ù…ÙˆÙ‚Ø¹.");
      }
    }

    // Ø¯Ø§Ù„Ø© Ù„Ø­Ø³Ø§Ø¨ Ø§Ù„Ù…Ø³Ø§ÙØ©
    function getDistance(lat1, lng1, lat2, lng2) {
      const R = 6371;
      const dLat = (lat2 - lat1) * Math.PI / 180;
      const dLng = (lng2 - lng1) * Math.PI / 180;
      const a = Math.sin(dLat / 2) * Math.sin(dLat / 2) +
                Math.cos(lat1 * Math.PI / 180) * Math.cos(lat2 * Math.PI / 180) *
                Math.sin(dLng / 2) * Math.sin(dLng / 2);
      const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));
      return R * c;
    }
  </script>

  <!-- ðŸ”‘ Google Maps API Key -->
  <script async defer
    src="https://maps.googleapis.com/maps/api/js?key=YOUR_API_KEY&callback=initMap">
  </script>
</body>
</html>
